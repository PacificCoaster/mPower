<pre class="code">
<span class="srcline"><span class="lineno"><a href="191,1" id="srcline1"> 1</a></span><span class="line"><span class="comment">% Computes mel-frequency cepstral coefficients (MFCCs) for an audio signal.</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Inputs:</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%  samples - mono audio signal</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% Outputs:</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%  cepstra - MFCC matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% (CC BY-SA 3.0) Max Little, 2014</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,9" id="srcline9"> 9</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T129U3">cepstra</span> = mfcc(<span class="var type1" id="S3T3U6">samples</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="191,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,11" id="srcline11">11</a></span><span class="line"><span class="comment">% Sample rate</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T1:U3"><span class="var type1" id="S4T1U9">sr</span> = <span class="mxinfo " id="T1:U5">44100</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,13" id="srcline13">13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,14" id="srcline14">14</a></span><span class="line"><span class="comment">% MFCC parameters</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T1:U6"><span class="var type1" id="S5T1U13">wintime</span> = <span class="mxinfo " id="T1:U8">0.020</span></span>;        <span class="comment">% Frame duration (sec)</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T1:U9"><span class="var type1" id="S6T1U17">numcep</span> = <span class="mxinfo " id="T1:U11">13</span></span>;            <span class="comment">% Number of cepstral coeffs to return</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T1:U12"><span class="var type1" id="S7T1U21">lifterexp</span> = <span class="mxinfo " id="T1:U14">0.6</span></span>;        <span class="comment">% Exponent for liftering</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T1:U15"><span class="var type1" id="S8T1U25">minfreq</span> = <span class="mxinfo " id="T1:U17">0</span></span>;            <span class="comment">% Lowest band edge of mel filters (Hz)</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T1:U18"><span class="var type1" id="S9T1U29">maxfreq</span> = <span class="mxinfo " id="T1:U20">8000</span></span>;         <span class="comment">% Highest band edge of mel filters (Hz)</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T1:U21"><span class="var type1" id="S10T1U33">nbands</span> = <span class="mxinfo " id="T1:U23">20</span></span>;            <span class="comment">% Number of warped spectral bands to use</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,22" id="srcline22">22</a></span><span class="line"><span class="comment">% Pre-compute data (assuming fixed sample rate and window length)</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T1:U24"><span class="var type1" id="S11T1U37">winpts</span> = <span class="mxinfo " id="T1:U26">round(<span class="var type1" id="S5T1U41">wintime</span>*<span class="var type1" id="S4T1U42">sr</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T1:U29"><span class="var type1" id="S13T1U45">nfft</span> = <span class="mxinfo " id="T1:U31">2^ceil(log2(<span class="var type1" id="S11T1U52">winpts</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T1:U33"><span class="var type1" id="S16T1U55">nfreqs</span> = <span class="mxinfo " id="T1:U35"><span class="var type1" id="S13T1U58">nfft</span>/2+1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T94:U37"><span class="var type1" id="S17T94U63">wndw</span> = <span class="mxinfo " id="T94:U39">hamming(<span class="var type1" id="S13T1U66">nfft</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo " id="T1:U41"><span class="var type1" id="S19T1U69">nframes</span> = <span class="mxinfo " id="T1:U43">ceil(<span class="mxinfo " id="T1:U44"><span class="mxinfo " id="T1:U45">length(<span class="var type1" id="S3T3U75">samples</span>)</span>/<span class="mxinfo " id="T1:U47"><span class="var type1" id="S13T1U76">nfft</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,28" id="srcline28">28</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,29" id="srcline29">29</a></span><span class="line"><span class="comment">% Conversion between mel/linear scales using O'Shaugnessy's formula</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,30" id="srcline30">30</a></span><span class="line"><span class="comment">% Anonymous functions are not supported for code generation, so these have</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,31" id="srcline31">31</a></span><span class="line"><span class="comment">% to be defined as their own functions (below)</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,32" id="srcline32">32</a></span><span class="line"><span class="comment">%fmel2hz = @(m) 700*(10.^(m/2595)-1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,33" id="srcline33">33</a></span><span class="line"><span class="comment">%fhz2mel = @(f) 2595*log10(1+f/700);</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,34" id="srcline34">34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,35" id="srcline35">35</a></span><span class="line"><span class="comment">% Pre-compute mel-scale auditory perceptual spectrum</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T97:U49"><span class="var type1" id="S21T97U79">melwts</span> = <span class="mxinfo " id="T97:U51">zeros(<span class="mxinfo " id="T1:U52"><span class="var type1" id="S10T1U82">nbands</span></span>,<span class="mxinfo " id="T1:U54"><span class="var type1" id="S13T1U83">nfft</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo " id="T95:U56"><span class="var type1" id="S23T95U86">fftfrqs</span> = <span class="mxinfo " id="T95:U58">(0:<span class="var type1" id="S13T1U93">nfft</span>-1)/<span class="var type1" id="S13T1U95">nfft</span>*<span class="var type1" id="S4T1U96">sr</span></span></span>;           <span class="comment">% Center freqs of each FFT bin</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,38" id="srcline38">38</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,39" id="srcline39">39</a></span><span class="line"><span class="comment">% Get center of mel bands uniformly spaced over given frequency range</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,40" id="srcline40">40</a></span><span class="line"><span class="mxinfo " id="T1:U62"><span class="var type1" id="S24T1U99">minmel</span> = <span class="mxinfo " id="T1:U64"><span class="fcn" id="F1145N14:B101">fhz2mel</span>(<span class="var type1" id="S8T1U102">minfreq</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,41" id="srcline41">41</a></span><span class="line"><span class="mxinfo " id="T1:U66"><span class="var type1" id="S26T1U105">maxmel</span> = <span class="mxinfo " id="T1:U68"><span class="fcn" id="F1145N14:B107">fhz2mel</span>(<span class="var type1" id="S9T1U108">maxfreq</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo " id="T96:U70"><span class="var type1" id="S27T96U111">binfrqs</span> = <span class="mxinfo " id="T96:U72"><span class="fcn" id="F1173N15:B113">fmel2hz</span>(<span class="var type1" id="S24T1U115">minmel</span>+(0:(<span class="var type1" id="S10T1U123">nbands</span>+1))/(<span class="var type1" id="S10T1U127">nbands</span>+1)*(<span class="var type1" id="S26T1U131">maxmel</span>-<span class="var type1" id="S24T1U132">minmel</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,43" id="srcline43">43</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,44" id="srcline44">44</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S29T1U135">i</span> = <span class="mxinfo " id="T1:U79">1</span>:<span class="var type1" id="S10T1U138">nbands</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,45" id="srcline45">45</a></span><span class="line">  <span class="mxinfo " id="T49:U81"><span class="var type1" id="S30T49U141">fs</span> = <span class="mxinfo " id="T49:U83"><span class="var type1" id="S27T96U143">binfrqs</span>(<span class="mxinfo " id="T49:U85"><span class="var type1" id="S29T1U145">i</span>+<span class="mxinfo " id="T49:U87">[<span class="mxinfo " id="T1:U88">0</span> <span class="mxinfo " id="T1:U89">1</span> <span class="mxinfo " id="T1:U90">2</span>]</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,46" id="srcline46">46</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,47" id="srcline47">47</a></span><span class="line">  <span class="comment">% Compute lower and upper slopes for all bins</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,48" id="srcline48">48</a></span><span class="line">  <span class="mxinfo " id="T95:U91"><span class="var type1" id="S31T95U153">loslope</span> = <span class="mxinfo " id="T95:U93">(<span class="mxinfo " id="T95:U94"><span class="var type1" id="S23T95U157">fftfrqs</span>-<span class="mxinfo " id="T1:U96"><span class="var type1" id="S30T49U159">fs</span>(<span class="mxinfo " id="T1:U98">1</span>)</span></span>)/(<span class="mxinfo " id="T1:U99"><span class="mxinfo " id="T1:U100"><span class="var type1" id="S30T49U164">fs</span>(<span class="mxinfo " id="T1:U102">2</span>)</span>-<span class="mxinfo " id="T1:U103"><span class="var type1" id="S30T49U167">fs</span>(<span class="mxinfo " id="T1:U105">1</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,49" id="srcline49">49</a></span><span class="line">  <span class="mxinfo " id="T95:U106"><span class="var type1" id="S32T95U171">hislope</span> = <span class="mxinfo " id="T95:U108">(<span class="mxinfo " id="T95:U109"><span class="mxinfo " id="T1:U110"><span class="var type1" id="S30T49U176">fs</span>(<span class="mxinfo " id="T1:U112">3</span>)</span>-<span class="var type1" id="S23T95U178">fftfrqs</span></span>)/(<span class="mxinfo " id="T1:U114"><span class="mxinfo " id="T1:U115"><span class="var type1" id="S30T49U182">fs</span>(<span class="mxinfo " id="T1:U117">3</span>)</span>-<span class="mxinfo " id="T1:U118"><span class="var type1" id="S30T49U185">fs</span>(<span class="mxinfo " id="T1:U120">2</span>)</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,50" id="srcline50">50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,51" id="srcline51">51</a></span><span class="line">  <span class="comment">% Form triangular mel-scale band kernel function</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,52" id="srcline52">52</a></span><span class="line">  <span class="mxinfo " id="T95:U121"><span class="mxinfo " id="T95:U122"><span class="var type1" id="S21T97U190">melwts</span>(<span class="var type1" id="S29T1U191">i</span>,:)</span> = <span class="mxinfo " id="T95:U125">max(<span class="mxinfo " id="T1:U126">0</span>,<span class="mxinfo " id="T95:U127">min(<span class="var type1" id="S31T95U198">loslope</span>,<span class="var type1" id="S32T95U199">hislope</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,53" id="srcline53">53</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,54" id="srcline54">54</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,55" id="srcline55">55</a></span><span class="line"><span class="comment">% Only use positive frequency part of Fourier transform</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,56" id="srcline56">56</a></span><span class="line"><span class="mxinfo " id="T107:U130"><span class="var type1" id="S21T107U202">melwts</span> = <span class="mxinfo " id="T107:U132"><span class="var type1" id="S21T97U204">melwts</span>(:,<span class="mxinfo " id="T105:U134"><span class="mxinfo " id="T1:U135">1</span>:<span class="mxinfo " id="T1:U136"><span class="var type1" id="S16T1U208">nfreqs</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,57" id="srcline57">57</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,58" id="srcline58">58</a></span><span class="line"><span class="comment">% Make the unitary DCT matrix for log mel-power spectra to cepstra</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,59" id="srcline59">59</a></span><span class="line"><span class="mxinfo " id="T99:U138"><span class="var type1" id="S35T99U211">dctm</span> = <span class="mxinfo " id="T99:U140">zeros(<span class="mxinfo " id="T1:U141"><span class="var type1" id="S6T1U214">numcep</span></span>, <span class="mxinfo " id="T1:U143"><span class="var type1" id="S10T1U215">nbands</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,60" id="srcline60">60</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S29T1U218">i</span> = <span class="mxinfo " id="T1:U146">1</span>:<span class="var type1" id="S6T1U221">numcep</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,61" id="srcline61">61</a></span><span class="line">    <span class="mxinfo " id="T98:U148"><span class="mxinfo " id="T98:U149"><span class="var type1" id="S35T99U225">dctm</span>(<span class="var type1" id="S29T1U226">i</span>,:)</span> = <span class="mxinfo " id="T98:U152"><span class="mxinfo " id="T98:U153">cos(<span class="mxinfo " id="T98:U154"><span class="mxinfo " id="T98:U155"><span class="mxinfo " id="T98:U156">(<span class="mxinfo " id="T1:U157"><span class="var type1" id="S29T1U236">i</span>-<span class="mxinfo " id="T1:U159">1</span></span>)*(<span class="mxinfo " id="T98:U160">1:2:(2*<span class="var type1" id="S10T1U247">nbands</span>-1)</span>)</span>/(<span class="mxinfo " id="T1:U162">2*<span class="var type1" id="S10T1U252">nbands</span></span>)</span>*<span class="mxinfo " id="T1:U164">pi</span></span>)</span> * <span class="mxinfo " id="T1:U165">sqrt(2/<span class="var type1" id="S10T1U259">nbands</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,62" id="srcline62">62</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,63" id="srcline63">63</a></span><span class="line"><span class="mxinfo " id="T98:U167"><span class="mxinfo " id="T98:U168"><span class="var type1" id="S35T99U263">dctm</span>(<span class="mxinfo " id="T1:U170">1</span>,:)</span> = <span class="mxinfo " id="T98:U171"><span class="mxinfo " id="T98:U172"><span class="var type1" id="S35T99U268">dctm</span>(<span class="mxinfo " id="T1:U174">1</span>,:)</span>/<span class="mxinfo " id="T1:U175">sqrt(2)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,64" id="srcline64">64</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,65" id="srcline65">65</a></span><span class="line"><span class="comment">% Construct liftering weight matrix (N.B. lifterexp &gt; 0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,66" id="srcline66">66</a></span><span class="line"><span class="mxinfo " id="T101:U176"><span class="var type1" id="S39T101U276">liftwts</span> = <span class="mxinfo " id="T101:U178">[1 (1:(<span class="var type1" id="S6T1U286">numcep</span>-1)).^<span class="var type1" id="S7T1U288">lifterexp</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,67" id="srcline67">67</a></span><span class="line"><span class="mxinfo " id="T102:U181"><span class="var type1" id="S40T102U291">liftermat</span> = <span class="mxinfo " id="T102:U183">diag(<span class="var type1" id="S39T101U294">liftwts</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,68" id="srcline68">68</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,69" id="srcline69">69</a></span><span class="line"><span class="comment">% Compute windowed power spectrum for each frame</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,70" id="srcline70">70</a></span><span class="line"><span class="keyword">if</span> coder.target(<span class="string">'MATLAB'</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="191,71" id="srcline71">71</a></span><span class="line">    <span class="var type0" id="S43T0U304">sampbuff</span> = buffer(<span class="var type0" id="S3T0U307">samples</span>,<span class="var type0" id="S13T0U308">nfft</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="191,72" id="srcline72">72</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,73" id="srcline73">73</a></span><span class="line">    <span class="mxinfo " id="T1:U185"><span class="var type1" id="S45T1U312">buflen</span> = <span class="mxinfo " id="T1:U187">(<span class="mxinfo " id="T1:U188"><span class="mxinfo " id="T1:U189"><span class="mxinfo " id="T1:U190">length(<span class="var type1" id="S3T3U319">samples</span>)</span> + <span class="mxinfo " id="T1:U192"><span class="var type1" id="S13T1U320">nfft</span></span></span> - <span class="mxinfo " id="T1:U194">1</span></span>) / <span class="mxinfo " id="T1:U195"><span class="var type1" id="S13T1U322">nfft</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,74" id="srcline74">74</a></span><span class="line">    <span class="mxinfo " id="T103:U197"><span class="var type1" id="S43T103U325">sampbuff</span> = <span class="mxinfo " id="T103:U199">zeros(<span class="mxinfo " id="T1:U200"><span class="var type1" id="S13T1U328">nfft</span></span>,<span class="var type1" id="S45T1U329">buflen</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,75" id="srcline75">75</a></span><span class="line">    coder.ceval(<span class="string">'buffer_nooverlap'</span>,coder.ref(<span class="mxinfo " id="T103:U203"><span class="var type1" id="S43T103U340">sampbuff</span></span>),<span class="var type1" id="S3T3U341">samples</span>,<span class="mxinfo " id="T1:U206">length(<span class="var type1" id="S3T3U344">samples</span>)</span>,<span class="mxinfo " id="T1:U208"><span class="var type1" id="S13T1U345">nfft</span></span>);</span></span>
<span class="srcline"><span class="lineno"><a href="191,76" id="srcline76">76</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,77" id="srcline77">77</a></span><span class="line"><span class="comment">%sampbuff = buffer(samples,nfft);</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,78" id="srcline78">78</a></span><span class="line"><span class="mxinfo " id="T103:U210"><span class="var type1" id="S43T103U348">sampbuff</span> = <span class="mxinfo " id="T103:U212"><span class="var type1" id="S43T103U350">sampbuff</span>.*<span class="mxinfo " id="T103:U214">repmat(<span class="var type1" id="S17T94U353">wndw</span>,1,<span class="var type1" id="S19T1U355">nframes</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,79" id="srcline79">79</a></span><span class="line"><span class="mxinfo " id="T103:U217"><span class="var type1" id="S47T103U358">pspectrum</span> = <span class="mxinfo " id="T103:U219"><span class="mxinfo " id="T103:U220">abs(<span class="mxinfo " id="T106:U221">fft(<span class="var type1" id="S43T103U364">sampbuff</span>)</span>)</span>.^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,80" id="srcline80">80</a></span><span class="line"><span class="mxinfo " id="T108:U223"><span class="var type1" id="S47T108U368">pspectrum</span> = <span class="mxinfo " id="T108:U225"><span class="var type1" id="S47T103U370">pspectrum</span>(<span class="mxinfo " id="T105:U227"><span class="mxinfo " id="T1:U228">1</span>:(<span class="mxinfo " id="T1:U229"><span class="var type1" id="S13T1U376">nfft</span>/2+1</span>)</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,81" id="srcline81">81</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,82" id="srcline82">82</a></span><span class="line"><span class="comment">% Sum over FFT bins to form mel-scale bins</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,83" id="srcline83">83</a></span><span class="line"><span class="mxinfo " id="T128:U231"><span class="var type1" id="S50T128U382">aspectrum</span> = <span class="mxinfo " id="T128:U233"><span class="var type1" id="S21T107U384">melwts</span>*<span class="var type1" id="S47T108U385">pspectrum</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,84" id="srcline84">84</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,85" id="srcline85">85</a></span><span class="line"><span class="comment">% Convert to cepstra via DCT</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,86" id="srcline86">86</a></span><span class="line"><span class="mxinfo " id="T129:U236"><span class="var type1" id="S2T129U388">cepstra</span> = <span class="mxinfo " id="T129:U238"><span class="var type1" id="S35T99U390">dctm</span>*<span class="mxinfo " id="T128:U240">log(<span class="mxinfo " id="T128:U241"><span class="var type1" id="S50T128U394">aspectrum</span>+<span class="mxinfo " id="T1:U243">1e-5</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,87" id="srcline87">87</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,88" id="srcline88">88</a></span><span class="line"><span class="comment">% Apply liftering weights</span></span></span>
<span class="srcline"><span class="lineno"><a href="191,89" id="srcline89">89</a></span><span class="line"><span class="mxinfo " id="T129:U244"><span class="var type1" id="S2T129U398">cepstra</span> = <span class="mxinfo " id="T129:U246"><span class="var type1" id="S40T102U400">liftermat</span>*<span class="var type1" id="S2T129U401">cepstra</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="191,90" id="srcline90">90</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="191,91" id="srcline91">91</a></span><span class="line"></span></span>
</pre>
