<pre class="code">
<span class="srcline"><span class="lineno"><a href="152,1" id="srcline1"> 1</a></span><span class="line"><span class="comment">% Computes basic tapping test features.</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Inputs:</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%  tap - tapping data vector: tap(:,1) - time points,</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%        tap(:,2:3) - X,Y touch screen coordinates</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% (CC BY-SA 3.0) Max Little, 2014</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,7" id="srcline7"> 7</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T8U3">ft</span> = features_bta(<span class="var type1" id="S3T48U6">tap</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="152,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% Output feature vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T8:U3"><span class="var type1" id="S2T8U9">ft</span> = <span class="mxinfo " id="T8:U5">NaN(<span class="mxinfo " id="T1:U6">1</span>,<span class="mxinfo " id="T1:U7">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,11" id="srcline11">11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,12" id="srcline12">12</a></span><span class="line"><span class="comment">% Ignore zero-length inputs</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T1:U8"><span class="var type1" id="S5T1U16">N</span> = <span class="mxinfo " id="T1:U10">size(<span class="var type1" id="S3T48U19">tap</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,14" id="srcline14">14</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo " id="T2:U12"><span class="var type1" id="S5T1U25">N</span> == <span class="mxinfo " id="T1:U14">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="152,15" id="srcline15">15</a></span><span class="line">    <span class="keyword">return</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,16" id="srcline16">16</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,17" id="srcline17">17</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,18" id="srcline18">18</a></span><span class="line"><span class="comment">% Calculate relative time</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T3:U15"><span class="var type1" id="S7T3U30">t</span> = <span class="mxinfo " id="T3:U17"><span class="mxinfo " id="T3:U18"><span class="var type1" id="S3T48U33">tap</span>(:,<span class="mxinfo " id="T1:U20">1</span>)</span>-<span class="mxinfo " id="T1:U21"><span class="var type1" id="S3T48U37">tap</span>(<span class="mxinfo " id="T1:U23">1</span>,<span class="mxinfo " id="T1:U24">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T1:U25"><span class="var type1" id="S8T1U42">T</span> = <span class="mxinfo " id="T1:U27"><span class="var type1" id="S3T48U44">tap</span>(<span class="mxinfo " id="T1:U29">end</span>,<span class="mxinfo " id="T1:U30">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,21" id="srcline21">21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,22" id="srcline22">22</a></span><span class="line"><span class="comment">% X,Y offset</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T3:U31"><span class="var type1" id="S10T3U50">tapx</span> = <span class="mxinfo " id="T3:U33"><span class="var type1" id="S3T48U52">tap</span>(:,<span class="mxinfo " id="T1:U35">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T3:U36"><span class="var type1" id="S11T3U57">tapy</span> = <span class="mxinfo " id="T3:U38"><span class="var type1" id="S3T48U59">tap</span>(:,<span class="mxinfo " id="T1:U40">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T3:U41"><span class="var type1" id="S10T3U64">tapx</span> = <span class="mxinfo " id="T3:U43"><span class="var type1" id="S10T3U66">tapx</span>-<span class="mxinfo " id="T1:U45">mean(<span class="var type1" id="S10T3U69">tapx</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T3:U47"><span class="var type1" id="S11T3U72">tapy</span> = <span class="mxinfo " id="T3:U49"><span class="var type1" id="S11T3U74">tapy</span>-<span class="mxinfo " id="T1:U51">mean(<span class="var type1" id="S11T3U77">tapy</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,27" id="srcline27">27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,28" id="srcline28">28</a></span><span class="line"><span class="comment">% Find left/right finger 'depress' events</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,29" id="srcline29">29</a></span><span class="line"><span class="mxinfo " id="T3:U53"><span class="var type1" id="S13T3U80">dx</span> = <span class="mxinfo " id="T3:U55">diff(<span class="var type1" id="S10T3U83">tapx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,30" id="srcline30">30</a></span><span class="line"><span class="mxinfo " id="T42:U57"><span class="var type1" id="S15T42U86">i</span> = (<span class="mxinfo " id="T42:U59"><span class="mxinfo " id="T3:U60">abs(<span class="var type1" id="S13T3U91">dx</span>)</span> &gt; <span class="mxinfo " id="T1:U62">20</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,31" id="srcline31">31</a></span><span class="line"><span class="mxinfo " id="T3:U63"><span class="var type1" id="S17T3U95">ttx</span> = <span class="mxinfo " id="T3:U65"><span class="var type1" id="S7T3U97">t</span>(<span class="var type1" id="S15T42U98">i</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,32" id="srcline32">32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,33" id="srcline33">33</a></span><span class="line"><span class="comment">% Find depress event intervals</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T3:U68"><span class="var type1" id="S18T3U101">dtx</span> = <span class="mxinfo " id="T3:U70">diff(<span class="var type1" id="S17T3U104">ttx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,35" id="srcline35">35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,36" id="srcline36">36</a></span><span class="line"><span class="comment">% Median and spread of tapping rate</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo " id="T1:U72"><span class="var type1" id="S19T1U107">tapdt</span> = <span class="mxinfo " id="T1:U74">median(<span class="var type1" id="S18T3U110">dtx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo " id="T1:U76"><span class="var type1" id="S21T1U113">tapiqr</span> = <span class="mxinfo " id="T1:U78">iqr(<span class="var type1" id="S18T3U116">dtx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="152,39" id="srcline39">39</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="152,40" id="srcline40">40</a></span><span class="line"><span class="comment">% Output tapping test feature vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="152,41" id="srcline41">41</a></span><span class="line"><span class="mxinfo " id="T8:U80"><span class="var type1" id="S2T8U119">ft</span> = <span class="mxinfo " id="T8:U82">[<span class="var type1" id="S19T1U122">tapdt</span> <span class="var type1" id="S21T1U123">tapiqr</span>]</span></span>;</span></span>
</pre>
